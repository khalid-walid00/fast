<section class="py-16">
  <div class="container ">
    <style>
      /* Mobile reviews slider paddings and arrow layering */
      .reviews-swiper .swiper-wrapper { align-items: stretch; }
      .reviews-swiper .swiper-slide { padding-inline: 8px; }
      .reviews-swiper .nav-btn { z-index: 10; }
    </style>

    <div class="section-title-container md:mb-10 mb-4">
      <h2 class="section-title">{{ widget.data.title | default('آراء عملائنا') }}</h2>
    </div>

    {% if widget.blocks.length > 0 %}
      <!-- Mobile Swiper -->
      <div class="md:hidden swiper reviews-swiper relative">
        <div class="swiper-wrapper">
          {% for block in widget.blocks %}
          <div class="swiper-slide">
            <div class="review-card">
              <span class="material-symbols-outlined review-quote">format_quote</span>
              <p class="review-text">{{ block.data.text | default('تجربة تسوق سلسة وسهلة من البداية للنهاية. أعجبتني سرعة التوصيل والتغليف الآمن') }}</p>
              <div class="review-footer">
                {% if block.data.image and block.data.image.fileUrl %}
                  <img src="{{ block.data.image.fileUrl }}" alt="{{ block.data.alt | default('[صورة العميل]') }}" class="review-avatar">
                {% else %}
                  <img src="https://i.pravatar.cc/48?u={{ block.data.name | urlencode }}" alt="{{ block.data.alt | default('[صورة العميل]') }}" class="review-avatar">
                {% endif %}
                <span class="review-name">{{ block.data.name | default('عبدالرحمن محمد') }}</span>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>

        <div class="swiper-pagination"></div>

        <button class="nav-btn nav-prev" aria-label="السابق">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
            <path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
        </button>

        <button class="nav-btn nav-next" aria-label="التالي">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
            <path d="m8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/>
          </svg>
        </button>
      </div>
      
      <script>
        document.addEventListener('DOMContentLoaded', function() {
          const reviewsSwiper = new Swiper('.reviews-swiper', {
            slidesPerView: 1,
            spaceBetween: 16,
            centeredSlides: true,
            loop: true,
            autoplay: {
              delay: 5000,
              disableOnInteraction: false,
            },
            pagination: {
              el: '.reviews-swiper .swiper-pagination',
              clickable: true,
            },
            navigation: {
              nextEl: '.reviews-swiper .nav-next',
              prevEl: '.reviews-swiper .nav-prev',
            },
            breakpoints: {
              640: {
                slidesPerView: 1.5,
                spaceBetween: 20,
              },
              768: {
                slidesPerView: 2,
                spaceBetween: 24,
              },
            },
          });
        });
      </script>

      <!-- Desktop Grid -->
      <div class="hidden md:grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
        {% for block in widget.blocks %}
        <div class="review-card">
          <span class="material-symbols-outlined review-quote">format_quote</span>
          <p class="review-text">{{ block.data.text | default('تجربة تسوق سلسة وسهلة من البداية للنهاية. أعجبتني سرعة التوصيل والتغليف الآمن') }}</p>
          <div class="review-footer">
            {% if block.data.image and block.data.image.fileUrl %}
              <img src="{{ block.data.image.fileUrl }}" alt="{{ block.data.alt | default('[صورة العميل]') }}" class="review-avatar">
            {% else %}
              <img src="https://i.pravatar.cc/48?u={{ block.data.name | urlencode }}" alt="{{ block.data.alt | default('[صورة العميل]') }}" class="review-avatar">
            {% endif %}
            <span class="review-name">{{ block.data.name | default('عبدالرحمن محمد') }}</span>
          </div>
        </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</section>
