<section class="hero-bg overflow-hidden">
  {% if widget.blocks.length > 0 %}

    <div class="hero-swiper swiper relative  max-md:min-h-[282px]" data-bg="{{ widget.blocks[0].data.text_section_background_color | default('#B9C1B6') }}">
      <div class="swiper-wrapper">
        {% set heroTitleKeys = ['elegant_furniture_title','exclusive_offers_title','guaranteed_quality_title'] %}
        {% set heroSubtitleKeys = ['discover_collection_subtitle','discounts_subtitle','high_quality_subtitle'] %}
        {% set defaultHeroImages = [
          'https://images.unsplash.com/photo-1555041469-a586c61ea9bc?auto=format&fit=crop&w=1600&q=80',
          'https://images.unsplash.com/photo-1524758631624-e2822e304c36?auto=format&fit=crop&w=1600&q=80',
          'https://images.unsplash.com/photo-1501045661006-fcebe0257c3f?auto=format&fit=crop&w=1600&q=80'
        ] %}
        {% for block in widget.blocks %}
        <div class="swiper-slide" data-slide-index="{{ loop.index }}" data-bg="{{ block.data.text_section_background_color | default('#B9C1B6') }}">
          <div class="hero-split-container flex" data-slide="{{ loop.index }}">
            <!-- {% if t('dir') == 'rtl' %}Left{% else %}Right{% endif %} side - Text content section with colored background -->
            <div class="hero-text-section flex-1 flex flex-col justify-center relative order-1 md:order-1">
              <div class="container mx-auto px-4 md:px-8 lg:px-16">
                <div class="{% if t('dir') == 'rtl' %}text-right{% else %}text-left{% endif %} max-w-[500px] md:max-w-[760px] w-full flex flex-col md:gap-12 gap-6">
                 <div class="flex flex-col md:gap-5 gap-3">
                  {% set titleText = block.data.title %}
                  {% if not titleText %}{% set titleText = 'اثاث انيق لمنزلك العصري' %}{% endif %}
                  {% set subtitleText = block.data.subtitle %}
                  {% if not subtitleText %}{% set subtitleText = 'اكتشف تشكيلتنا الواسعة من الأثاث بتصاميم عصرية وجودة عالية' %}{% endif %}
                  <h1 class="md:text-[40px] md:leading-[60px] font-bold md:font-extrabold text-secondary {% if t('dir') == 'rtl' %}text-right{% else %}text-left{% endif %} block hero-title-main">
                    {{ titleText | safe }}
                  </h1>
                  <div class="md:text-[24px] text-sm md:leading-[36px] leading-[20px] text-secondary {% if t('dir') == 'rtl' %}text-right{% else %}text-left{% endif %} whitespace-normal hero-balance">
                    {{ subtitleText | safe }}
                  </div>
                </div>
                  <a href="{{ block.data.link | default('/collections') }}" class="flex items-center justify-center h-[52px] bg-white rounded-lg text-secondary md:max-w-[438px] max-w-[300px] w-full md:text-base text-sm text-center md:font-bold font-semibold hover:bg-gray-50 transition-colors duration-200">
                    {{ t('shop_now') }}
                  </a>
                </div>
              </div>
            </div>
            
            <!-- {% if t('dir') == 'rtl' %}Right{% else %}Left{% endif %} side - Image section -->
            <div class="hero-image-section flex-1 relative order-2 md:order-2" style="background: transparent; padding: 0; margin: 0;">
              {% set imageUrl = defaultHeroImages[loop.index0] %}
              {% if block.data.image %}
                {% if block.data.image.fileUrl %}
                  {% set imageUrl = block.data.image.fileUrl %}
                {% elseif block.data.image is string and block.data.image|length > 0 %}
                  {% set imageUrl = block.data.image %}
                {% endif %}
              {% endif %}
              <img src="{{ imageUrl }}" alt="{{ t(block.data.alt | default('hero_image_alt')) }}" class="hero-split-image" style="width: 100%; height: 100%; object-fit: cover; display: block; margin: 0; padding: 0;">
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
      
      {% if widget.data.show_pagination %}
        <div class="swiper-pagination max-md:-right-[5.5rem]"></div>
      {% endif %}
    </div>
    
    <style>
      .hero-swiper .swiper-pagination .swiper-pagination-bullet {
        width: 12px !important;
        height: 12px !important;
        background: #000000 !important;
        opacity: 0.3 !important;
        margin: 0 6px !important;
        border-radius: 50% !important;
        border: 2px solid #000000 !important;
        transition: all 0.3s ease !important;
      }
      .hero-swiper .swiper-pagination .swiper-pagination-bullet-active {
        background: #000000 !important;
        opacity: 1 !important;
        transform: scale(1.2) !important;
        border: 3px solid #000000 !important;
      }
      .hero-swiper .swiper-pagination {
        bottom: 20px !important;
        transform: none !important;
        position: absolute !important;
        z-index: 10 !important;
        width: auto !important;
      }
      .hero-title-main {
        width: 481px;
        height: 72px;
        transform: rotate(0deg);
        opacity: 1;
      }
    </style>
    
    
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // التأكد من وجود السلايدر قبل تهيئته
        const swiperContainer = document.querySelector('.hero-swiper');
        if (!swiperContainer) return;
        
        const heroSwiper = new Swiper('.hero-swiper', {
          loop: true,
          // autoplay: {
          //   delay: 5000,
          //   disableOnInteraction: false,
          //   pauseOnMouseEnter: true,
          // },
          speed: 1000,
          allowTouchMove: true,
          grabCursor: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          on: {
            init: function() {
              const container = this.el;
              const initialSlide = this.slides[this.activeIndex];
              const initialBg = (initialSlide && initialSlide.dataset && initialSlide.dataset.bg) || container.dataset.bg;
              if (initialBg) {
                container.style.backgroundColor = initialBg;
              }
            },
            slideChange: function() {
              const container = this.el;
              const activeSlide = this.slides[this.activeIndex];
              const bg = activeSlide && activeSlide.dataset ? activeSlide.dataset.bg : null;
              if (bg) {
                container.style.backgroundColor = bg;
              }
            }
          }
        });
      });
    </script>
  {% else %}
    <!-- Hero Default (Fallback) -->
    <div class="hero-split-container flex" data-slide="1">
      <!-- {% if t('dir') == 'rtl' %}Left{% else %}Right{% endif %} side - Text content section with colored background -->
      <div class="hero-text-section flex-1 flex flex-col justify-center relative" style="background-color: #B9C1B6;">
        <div class="container mx-auto px-4 md:px-8 lg:px-16">
          <div class="{% if t('dir') == 'rtl' %}text-right{% else %}text-left{% endif %} max-w-[500px] w-full flex flex-col md:gap-12 gap-6">
            <div class="flex flex-col md:gap-5 gap-3">
              <h1 class="md:text-[40px] md:leading-[60px] text-[34px] leading-[42px] font-bold md:font-extrabold text-secondary {% if t('dir') == 'rtl' %}text-right{% else %}text-left{% endif %} block">
                اثاث انيق لمنزلك العصري
              </h1>
              <p class="md:text-[24px] text-sm md:leading-[36px] leading-[20px] text-secondary {% if t('dir') == 'rtl' %}text-right{% else %}text-left{% endif %}">
                اكتشف تشكيلتنا الواسعة من الأثاث بتصاميم عصرية وجودة عالية
              </p>
            </div>
            <a :href="handleRedirect('collections')" class="flex items-center justify-center h-[52px] bg-white rounded-lg text-secondary md:max-w-[438px] max-w-[300px] w-full md:text-base text-sm text-center md:font-bold font-semibold hover:bg-gray-50 transition-colors duration-200">
              {{t('shop_now')}}
            </a>
          </div>
        </div>
      </div>
      
      <!-- {% if t('dir') == 'rtl' %}Right{% else %}Left{% endif %} side - Image section -->
      <div class="hero-image-section flex-1 relative" style="background: transparent; padding: 0; margin: 0;">
        <img src="https://images.unsplash.com/photo-1484101403633-562f891dc89a?auto=format&fit=crop&w=1600&q=80" alt="[كرسي مع وسادة وخلفية أنيقة]" class="hero-split-image" style="width: 100%; height: 100%; object-fit: cover; display: block; margin: 0; padding: 0;">
      </div>
    </div>
  {% endif %}
</section>

