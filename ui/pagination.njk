{% set current = context.pagination.currentPage|default(1) %}
{% set total = context.pagination.totalPages|default(1) %}
{% set maxPages = 4 %} 

<div class="flex justify-center" dir="{% if t('dir') == 'rtl' %}rtl{% else %}ltr{% endif %}">
  <nav class="flex items-center gap-2">
    {# Previous button #}
    {% if current > 1 %}
      <a href="?page={{ current - 1 }}"
         class="h-10 w-10 flex items-center justify-center border border-gray2 rounded-lg hover:bg-gray-100 transition">
         <span class="material-symbols-outlined text-xl">{% if t('dir') == 'rtl' %}arrow_right_alt{% else %}arrow_left_alt{% endif %}</span>
      </a>
    {% else %}
      <span class="h-10 w-10 flex items-center justify-center border border-gray-200 text-gray-400 rounded-lg cursor-not-allowed">
        <span class="material-symbols-outlined text-xl">{% if t('dir') == 'rtl' %}arrow_right_alt{% else %}arrow_left_alt{% endif %}</span>
      </span>
    {% endif %}

    {# Calculate page range #}
    {% set startPage = current - 1 %}
    {% if startPage < 1 %}
      {% set startPage = 1 %}
    {% endif %}
    {% set endPage = startPage + maxPages - 1 %}
    {% if endPage > total %}
      {% set endPage = total %}
      {% set startPage = total - maxPages + 1 %}
      {% if startPage < 1 %}
        {% set startPage = 1 %}
      {% endif %}
    {% endif %}

    {# Page numbers #}
    {% for page in range(startPage, endPage + 1) %}
      {% if page == current %}
        <span class="h-10 w-10 text-xl flex items-center justify-center rounded-lg bg-primary text-white">
          {{ page }}
        </span>
      {% else %}
        <a href="?page={{ page }}"
           class="h-10 w-10 text-xl flex items-center justify-center border border-gray2 rounded-lg hover:bg-gray-100">
          {{ page }}
        </a>
      {% endif %}
    {% endfor %}

    {# Next button #}
    {% if current < total %}
      <a href="?page={{ current + 1 }}"
         class="h-10 w-10 flex items-center justify-center border border-gray2 rounded-lg hover:bg-gray-100 transition">
         <span class="material-symbols-outlined text-xl">{% if t('dir') == 'rtl' %}arrow_left_alt{% else %}arrow_right_alt{% endif %}</span>
      </a>
    {% else %}
      <span class="h-10 w-10 flex items-center justify-center border border-gray-200 text-gray-400 rounded-lg cursor-not-allowed">
        <span class="material-symbols-outlined text-xl">{% if t('dir') == 'rtl' %}arrow_left_alt{% else %}arrow_right_alt{% endif %}</span>
      </span>
    {% endif %}
  </nav>
</div>